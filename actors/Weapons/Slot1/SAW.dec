Actor HasCutingWeapon: Inventory { inventory.maxamount 1}
ACTOR ComboSeq : Inventory {Inventory.MaxAmount 2}
ACTOR FiredGun : Inventory {Inventory.MaxAmount 1}
Actor SawFireSeq1: Inventory {inventory.maxamount 1}
Actor SawFireSeq2: Inventory {inventory.maxamount 1}
Actor ChainsawResourceGather: Inventory {inventory.maxamount 1}


Actor RespectSaw: Inventory {inventory.maxamount 1}

ACTOR ChainsawSSGCooldownActive : PowerUp {Powerup.Duration -10}
ACTOR ChainsawSSGCooldown : PowerupGiver 
{	PowerUp.Type "ChainsawSSGCooldownActive"
	+AUTOACTIVATE
}

// I have plans for this later :3
ACTOR PB_ChainsawPickup : PB_UpgradeItem
{
	//$Title Chainsaw
	//$Category Project Brutality - Weapons
	//$Sprite CSAWA0
	Inventory.PickupSound ""
	Inventory.PickupMessage ""
	Tag "Beavertooth Painsaw"
	Scale .49
	FloatBobStrength 0.5
	+DONTGIB
	States
	{
	Spawn:
		VSAW A 0 NoDelay
		CSAW A 10 A_PbvpFramework("VSAW")
		"####" A 0 A_PbvpInterpolate()
		LOOP

	Pickup:
		TNT1 A 0 A_JumpIfInventory("PB_Chainsaw",1,"PickupFuel")
		TNT1 A 0 A_Log("\c-MIXOM Beavertooth Painsaw (Slot 1)")
        TNT1 A 0 {
			A_GiveInventory ("PB_Chainsaw");
			if(GetCvar("nodoomguytalk") >= 1){
				A_StartSound("CSAWPICK",3,CHANF_NOPAUSE );}
			else{
				A_StartSound("IGOTSAW",3,CHANF_NOPAUSE );}
		}
		STOP
	PickupFuel:
		TNT1 A 0 A_JumpIfInventory("PB_Fuel",0,"DontPickup")
		TNT1 A 0 A_StartSound("CSAWGAS", 3, CHANF_NOPAUSE)
		TNT1 A 0 A_Log("\c-You already have the chainsaw, so you collect it's fuel instead!")
		TNT1 A 0 A_GiveInventory("PB_Fuel",30)
		Stop
	DontPickup:
		TNT1 A 1
		TNT1 A 0
		Fail
	}
}
	
Actor PB_Chainsaw  : PB_Weapon //replaces Chainsaw
{
	+FLOORCLIP
	+DONTGIB
	weapon.selectionorder 220
	Weapon.KickBack 0
	Weapon.AmmoType "PB_Fuel"
	Weapon.AmmoUse 3 // This will be adjusted when the flamethrower is overhauled
	Weapon.AmmoGive1 150
	Obituary "$OB_MPCHAINSAW"
	Inventory.PickUpSound "CSAWPICK"
	Weapon.UpSound "none"
	weapon.readysound "weapons/chainsaw/idle"
	Inventory.PickupMessage "MIXOM Beavertooth Painsaw (Slot 1)"
	+WEAPON.NOAUTOAIM
	+WEAPON.AXEBLOOD
	+WEAPON.NOALERT
	+WEAPON.MELEEWEAPON
	+WEAPON.AMMO_OPTIONAL
	Tag "Beavertooth Painsaw"
	Scale .49
	Inventory.AltHUDIcon "CSAWA0"
	FloatBobStrength 0.5
	PB_WeaponBase.respectItem "RespectSaw"
	states
	{
	Spawn:
		VSAW A 0 NoDelay
		CSAW A 10 A_PbvpFramework("VSAW")
		"####" A 0 A_PbvpInterpolate()
		LOOP
		
		Select:
		TNT1 A 0 {
			A_WeaponOffset(0,32);
			A_SetRoll(0);
			PB_HandleCrosshair(90);
			A_SetInventory("PB_LockScreenTilt",0);
		}
		Goto SelectFirstPersonLegs
	SelectContinue:
		TNT1 A 0 PB_WeapTokenSwitch("SawSelected")
		TNT1 A 0 PB_ResetVisorBloodTokens
		TNT1 A 0 PB_ResetBarrelTokens
			
		TNT1 AAAAAAAAAAAAAAAAAA 0 A_Raise
		TNT1 AAAA 1 A_Raise
		Wait
		
	Deselect:
		TNT1 A 0 A_JumpIfInventory ("GrabbedBarrel", 1, "PlaceBarrel")
		TNT1 A 0 A_JumpIfInventory ("GrabbedFlameBarrel", 1, "PlaceFlameBarrel")
		TNT1 A 0 A_JumpIfInventory ("GrabbedIceBarrel", 1, "PlaceIceBarrel")
		TNT1 A 0 {
			A_WeaponOffset(0,32);
			A_SetRoll(0);
			PB_HandleCrosshair(90);
			A_SetInventory("PB_LockScreenTilt",0);
		}
		TNT1 A 0 A_SetInventory("HasCutingWeapon",0)
		TNT1 A 0 A_SetInventory("SawSelected",0)
		TNT1 A 0 A_SetInventory("ComboSeq", 0)
		
		TNT1 A 0 A_Stopsound(1)
		S3WS A 0 A_JumpIfInventory("PowerGreenBloodOnVisor",1,4)
		S2WS A 0 A_JumpIfInventory("PowerBlueBloodOnVisor",1,3)
		S1WS A 0 A_JumpIfInventory("PowerBloodOnVisor",1,2)
		SAWS A 0
		"####" YXW 1
		"####" W 1 Offset(-15,46)
		"####" W 1 Offset(-25,58)
		"####" W 1 Offset(-35,70)
		TNT1 A 1 A_WeaponOffset(0,0)
		TNT1 A 0 PB_ResetVisorBloodTokens
		TNT1 AAAAAAAAAAAAAAAAAA 0 A_Lower
		Wait


	Steady:
		TNT1 A 1
		Goto Ready

	Ready3:
		TNT1 A 0
		Goto OnLoop

    Ready:
	    SAWS A 0
		TNT1 A 0 A_SetInventory("ComboSeq", 0)
		TNT1 A 0 A_SetInventory("FiredGun", 0)
		TNT1 A 0 A_SetInventory("HasCutingWeapon",0)
		TNT1 A 0 PB_RespectIfNeeded
	WeaponRespect:
		TNT1 A 0 {
			A_SetInventory("RespectSaw",1);
			A_SetInventory("ChainsawResourceGather",1);
		}
	SelectAnimation:
        SAWS WXYZ 1 A_SetRoll(roll+0.6,SPF_INTERPOLATE)
        TNT1 A 0 A_PlaySound("DSSAWZIP")
        SAWS A 1 A_Zoomfactor(0.98)
        SAWS B 1 A_Zoomfactor(0.96)
        SAWS C 1 A_Zoomfactor(0.98)
        SAWS D 1 A_Zoomfactor(1.0)
		SAWS EFGH 1 A_SetRoll(roll-0.6,SPF_INTERPOLATE)
		RIFF A 0 A_FireCustomMissile("GunFireSmoke", 0, 0, -5, -5, 0, 0)
		SAWS I 1
		RIFF A 0 A_FireCustomMissile("GunFireSmoke", 0, 0, -5, -5, 0, 0)
		SAWS J 1 A_playsound("weapons/chainsaw/draw", CHAN_AUTO)
		RIFF A 0 A_FireCustomMissile("GunFireSmoke", 0, 0, -5, -5, 0, 0)
		SAWS K 1 //A_PlaySound("DSSAWUP", 2)
		RIFF A 0 A_FireCustomMissile("GunFireSmoke", 0, 0, -5, -5, 0, 0)

        TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0
	OnLoop:
 		TNT1 A 0 { 
			A_StartSound("weapons/chainsaw/idle",CHAN_WEAPON,CHANF_LOOPING, 0.5);
			A_SetRoll(0);
			A_SetInventory("ComboSeq", 0);
			A_SetInventory("FiredGun", 0);
			A_SetInventory("HasCutingWeapon",0);
		}
	OnLoop1:
		TNT1 A 0 {
			if (CountInv("PowerGreenBloodOnVisor") == 1) { A_Overlay(-2,"BloodDrop"); }
			if (CountInv("PowerBlueBloodOnVisor") == 1) { A_Overlay(-2,"BloodDrop"); }
			if (CountInv("PowerBloodOnVisor") == 1) { A_Overlay(-2,"BloodDrop"); }
		}
		SAWG ABCDEFGFEDCB 1 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("SAW4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("SAW3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("SAW2"); }
			return A_DoPBWeaponAction;
		}
		Loop
	Ready.GreenBlood:
		TNT1 A 0 {
			A_SetInventory("PowerBlueBloodOnVisor", 0);
			A_SetInventory("PowerBloodOnVisor", 0);
		}
		Goto OnLoop
	Ready.BlueBlood:
		TNT1 A 0 {
			A_SetInventory("PowerBloodOnVisor", 0);
			A_SetInventory("PowerGreenBloodOnVisor", 0);
		}
		Goto OnLoop
	Ready.Blood:
		TNT1 A 0 {
			A_SetInventory("PowerBlueBloodOnVisor", 0);
			A_SetInventory("PowerGreenBloodOnVisor", 0);
		}
		Goto OnLoop
		
	BloodDrop:
		SSW4 ABCDEFGHIJKL 0
		SSW3 ABCDEFGHIJKL 0
		SSW2 ABCDEFGHIJKL 0
		TNT1 ABCDEFGHIJKL 1 {
			A_WeaponReady;
			if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetOverlaySprite(-2,"SSW4"); }
			if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetOverlaySprite(-2,"SSW3"); }
			if (CountInv("PowerBloodOnVisor") == 1) { A_SetOverlaySprite(-2,"SSW2"); }
		}
		TNT1 A 0 {
			if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SpawnItemEx("DripingSawGreenBlood", 0, -4, 2, 0, 0); }
			if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SpawnItemEx("DripingSawBlueBlood", 0, -4, 2, 0, 0); }
			if (CountInv("PowerBloodOnVisor") == 1) { A_SpawnItemEx("DripingSawBlood", 0, -4, 2, 0, 0); }
		}
		Stop
		
	Reload:
		TNT1 A 0 A_JumpIfInventory ("GrabbedBarrel", 1, "IdleBarrel")
		TNT1 A 0 A_JumpIfInventory ("GrabbedFlameBarrel", 1, "IdleFlameBarrel")
		TNT1 A 0 A_JumpIfInventory ("GrabbedIceBarrel", 1, "IdleIceBarrel")
		Goto Ready3
		
	WeaponSpecial:
		TNT1 A 0 A_JumpIfInventory ("GrabbedBarrel", 1, "IdleBarrel")
		TNT1 A 0 A_JumpIfInventory ("GrabbedFlameBarrel", 1, "IdleFlameBarrel")
		TNT1 A 0 A_JumpIfInventory ("GrabbedIceBarrel", 1, "IdleIceBarrel")
		TNT1 A 0 
			{
				A_WeaponOffset(0,32);
				A_SetInventory("GoWeaponSpecialAbility",0);
				if (CountInv("ChainsawResourceGather") >= 1) { 
					A_SetInventory("ChainsawResourceGather",0);
					A_Print("Chainsaw Resource Gather: Disabled");
				}
				else {
					A_SetInventory("ChainsawResourceGather",1);
					A_Print("Chainsaw Resource Gather: Enabled");
				}
		}
		
        TNT1 A 0 A_StartSound("DSSAWZIP", CHAN_AUTO)
        SAWS A 1 A_Zoomfactor(0.98)
        SAWS B 1 A_Zoomfactor(0.96)
        SAWS C 1 A_Zoomfactor(0.98)
        SAWS D 1 A_Zoomfactor(1.0)
		SAWS EFGH 1 A_SetRoll(roll-0.6,SPF_INTERPOLATE)
		SAWS I 1 A_FireCustomMissile("GunFireSmoke", 0, 0, -5, -5, 0, 0)
		SAWS J 1 {
			A_playsound("weapons/chainsaw/draw", CHAN_AUTO);
			A_FireCustomMissile("GunFireSmoke", 0, 0, -5, -5, 0, 0);
		}
		SAWS K 1 A_FireCustomMissile("GunFireSmoke", 0, 0, -5, -5, 0, 0)
		Goto OnLoop
		
	WeaponSpecialBlood:
		TNT1 A 0
		Goto Ready.Blood
		
	WeaponSpecialBlueBlood:
		TNT1 A 0
		Goto Ready.BlueBlood
		
	WeaponSpecialGreenBlood:
		TNT1 A 0
		Goto Ready.GreenBlood
		
	SSGFlash:
		TNT1 A 0 A_SetInventory("HasCutingWeapon",0)
		CSSG ATUB 1 A_SetRoll(roll+0.8,SPF_INTERPOLATE)
		TNT1 A 0 A_PlaySound("insertshell", 5)
		CSSG CEF 1
		TNT1 A 0 A_PlaySound("weapons/ssg/inspect3", 7)
		CSSG GH 1
		CSSG IIII 1 A_SetRoll(roll-0.8,SPF_INTERPOLATE)
		
		TNT1 A 0 A_TakeInventory("NewShell", 2)
		TNT1 A 0 A_AlertMonsters
		TNT1 A 0 A_GiveInventory("ChainsawSSGCooldown",1) 
	    CSSG J 1 BRIGHT A_FireBullets(0, 0, 1, 35, "shotpuff", 1, 220)
		TNT1 A 0  A_PlaySound("SSHFIRE", 6)
		TNT1 AAAAAAAAAAA 0 A_FireCustomMissile("Tracer", Random(-7, 7), 0, -1, Random(-7, 7))
		TNT1 A 0 A_FireBullets(15, 9, 22, 7, "ShotgunPuff")
		TNT1 AA 0 A_FireCustomMissile("YellowFlareSpawn", 15, 0, 0, 0)
		TNT1 AA 0 A_FireCustomMissile("YellowFlareSpawn", -15, 0, 0, 0)
		TNT1 A 0 A_SetPitch(-1.55 + pitch)
		CSSG K 1 BRIGHT
		CSSG LMNOONM 1
		TNT1 A 0 A_PlaySound("insertshell", 5)
		CSSG PQRS 1
		TNT1 A 0 A_PlaySound("weapons/ssg/inspect3", 7)
		Stop
		
	DontQuickShot:
		TNT1 A 0 A_Print ("Sawed-Off Quick Shot not ready!", 2)
		Goto OnLoop
		
//Revamping the chainsaw's primary fire behavior: Directional Swings based on movement direction, like in KF2
	Fire:
		TNT1 A 0 A_JumpIfInventory ("GrabbedBarrel", 1, "ThrowBarrel")
		TNT1 A 0 A_JumpIfInventory ("GrabbedFlameBarrel", 1, "ThrowFlameBarrel")
		TNT1 A 0 A_JumpIfInventory ("GrabbedIceBarrel", 1, "ThrowIceBarrel")
		SAW4 ABCDEFG 0
		SAW3 ABCDEFG 0
		SAW2 ABCDEFG 0
		SAWG ABCDEFG 0
		
		CSA4 ABCDEFG 0
		CSA3 ABCDEFG 0
		CSA2 ABCDEFG 0
		CSA1 ABCDEFG 0
		
		CSS4 ABCDEFGHIJKLMNOPQRS 0
		CSS3 ABCDEFGHIJKLMNOPQRS 0
		CSS2 ABCDEFGHIJKLMNOPQRS 0
		CSS1 ABCDEFGHIJKLMNOPQRS 0
		
		C4S4 ABCDEFGHIJKLMNOPQRS 0
		C4S3 ABCDEFGHIJKLMNOPQRS 0
		C4S2 ABCDEFGHIJKLMNOPQRS 0
		C4S1 ABCDEFGHIJKLMNOPQRS 0
		
		C5S4 ABCDEFGHIJKLMNOPQRSTUV 0
		C5S3 ABCDEFGHIJKLMNOPQRSTUV 0
		C5S2 ABCDEFGHIJKLMNOPQRSTUV 0
		C5S1 ABCDEFGHIJKLMNOPQRSTUV 0
		
		C6S4 ABCDEFGHIJKLMNOPQRS 0
		C6S3 ABCDEFGHIJKLMNOPQRS 0
		C6S2 ABCDEFGHIJKLMNOPQRS 0
		C6S1 ABCDEFGHIJKLMNOPQRS 0
		
		TNT1 A 0 {
			A_WeaponOffset(0,32);
			A_SetRoll(0);
			PB_HandleCrosshair(90);
		}
		"####" A 0 A_SetInventory("PB_LockScreenTilt",1)
		"####" A 0
			{
				A_AlertMonsters;
				A_StartSound("weapons/chainsaw/start", CHAN_AUTO,  CHANF_OVERLAP);
				A_SetInventory("HasCutingWeapon",1);
				return state("");
			}
		"####" A 0
			{
				if (CountInv("GreenBloodSplatterz") == 1) { 
					A_SetInventory("GreenBloodSplatterz", 0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("BlueBloodSplatterz") == 1) {	
					A_SetInventory("BlueBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("RedBloodSplatterz") == 1) {
					A_SetInventory("RedBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
				}
			}
//No Blood
	CleanAttack:
        SAWG A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("SAW4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("SAW3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("SAW2"); }
			}
		"####" A 1
		"####" A 0
			{
				A_AlertMonsters;
				A_SetInventory("HasCutingWeapon",1);
				
				
//				if(IsPressingInput(BT_MOVERIGHT)) { return state("RightAttackClean"); }
//				if(IsPressingInput(BT_MOVELEFT)) { return state("LeftAttackClean"); }
//				if(IsPressingInput(BT_FORWARD)) { return state("ForwardAttackClean"); }
//				if(IsPressingInput(BT_BACK)) { return state("BackwardAttackClean"); }

				Saw_SwingDirection();
				
// 				if (CountInv("MovingForward") == 1) { return state("ForwardAttackClean"); }
// 				if (CountInv("MovingRight") == 1) { return state("RightAttackClean"); }
// 				if (CountInv("MovingLeft") == 1) { return state("LeftAttackClean"); }
// 				if (CountInv("MovingBackward") == 1) { return state("BackwardAttackClean"); }
				return state("");
			}
	ClassicAttackClean:
		"####" A 0 A_PlaySound("sawswing", 6, 0.5)
        CSA1 A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("CSA4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("CSA3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("CSA2"); }
			}
		"####" ABCD 1
	ClassicAttackCleanLoop:
		
		CSA1 A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("CSA4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("CSA3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("CSA2"); }
			}
		"####" EFGFEFG 1 {
			if(PressingFire()) {
				PB_SawAttack;
				return state("");
			}
			else{
				return state("ClassicAttackStop");
			}
		}
		"####" A 0
			{
				if (CountInv("GreenBloodSplatterz") == 1) { 
					A_SetInventory("GreenBloodSplatterz", 0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("BlueBloodSplatterz") == 1) {	
					A_SetInventory("BlueBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("RedBloodSplatterz") == 1) {
					A_SetInventory("RedBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
				}
			}
		"####" A 0 A_StartSound ("weapons/chainsaw/loop", CHAN_7 , CHANF_LOOPING | CHANF_OVERLAP)
		"####" A 0 Saw_SwingDirection()
		"####" A 0 PB_ReFire("ClassicAttackCleanLoop")
	ClassicAttackStop:
		"####" A 0 {
			A_StopSound(CHAN_7);
			A_StartSound("CSAWSTAT", CHAN_AUTO, CHANF_OVERLAP );
			A_StartSound("weapons/chainsaw/stop", CHAN_AUTO);
			A_SetInventory("ComboSeq", 0);
		}
		"####" DCBA 1 A_FireCustomMissile("GunFireSmoke", 0, 0, -5, -5, 0, 0)
		SAWG A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("SAW4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("SAW3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("SAW2"); }
			}
		"####" GHGHGHGGHHGGHH 1 A_DoPBWeaponAction
		Goto EndCheck
		
	ForwardAttackClean:
		"####" A 0 A_StartSound("sawswing2", CHAN_AUTO, CHANF_OVERLAP )
	ForwardAttackClean1:
		CSS1 A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("CSS4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("CSS3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("CSS2"); }
			}
		"####" ABCDE 1
		"####" A 0 A_PlaySound("weapons/gswing", 2,0.6)
		"####" FGHI 1 A_SetRoll(roll-0.25,SPF_INTERPOLATE)
		Goto ForwardAttackCleanContinue+3
	ForwardAttackCleanContinue:
		CSS1 A 0 {
				if (CountInv("GreenBloodSplatterz") == 1) { 
					A_SetInventory("GreenBloodSplatterz", 0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("BlueBloodSplatterz") == 1) {	
					A_SetInventory("BlueBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("RedBloodSplatterz") == 1) {
					A_SetInventory("RedBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
				}
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("CSS4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("CSS3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("CSS2"); }
			}
		"####" JK 1 
		"####" L 1 {
			if(PressingFire()) {
				PB_SawAttack(true);
				PB_SawAttack(true);
				PB_SawAttack(true);
				return state("");
			}
			else{
				return state("ForwardAttackStop");
			}
		}
		"####" A 0 A_JumpIfCloser(119, "ForwardAttackCleanContinue")
	ForwardAttackStop:
		"####" MNO 1 PB_SawAttack(true)
		"####" PQRS 1 A_SetRoll(roll+0.25,SPF_INTERPOLATE)
		"####" A 0
			{
				if (CountInv("GreenBloodSplatterz") == 1) { 
					A_SetInventory("GreenBloodSplatterz", 0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("BlueBloodSplatterz") == 1) {	
					A_SetInventory("BlueBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("RedBloodSplatterz") == 1) {
					A_SetInventory("RedBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
				}
			}
		"####" A 0 A_StartSound ("weapons/chainsaw/loop", CHAN_7 , CHANF_LOOPING | CHANF_OVERLAP )
		"####" A 0 Saw_SwingDirection()
		"####" A 0 PB_ReFire("ForwardAttackClean1")
		"####" A 0 A_StopSound(CHAN_7)
		"####" A 0 A_StartSound("weapons/chainsaw/stop", CHAN_AUTO, CHANF_OVERLAP )
		"####" A 0 A_StartSound("CSAWSTAT", CHAN_AUTO, CHANF_OVERLAP )
		SAWG A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("SAW4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("SAW3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("SAW2"); }
			}
		"####" GHGHGHGGHHGGHH 1 A_DoPBWeaponAction
		Goto EndCheck
		
	RightAttackClean:
		"####" A 0 A_StartSound("sawswing", CHAN_AUTO, CHANF_OVERLAP, 0.4)
		"####" A 0 
		C4S1 A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("C4S4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("C4S3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("C4S2"); }
			}
		"####" ABCDE 1 A_SetRoll(roll+0.2,SPF_INTERPOLATE)
		Goto RightAttackCleanContinue+3
	RightAttackCleanContinue:
		C4S1 A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("C4S4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("C4S3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("C4S2"); }
			}
		"####" KL 1 
		"####" M 1 {
			if(PressingFire()) {
				PB_SawAttack;
				PB_SawAttack;
				PB_SawAttack;
				return state("");
			}
			else{
				return state("RightAttack1Stop");
			}
		}
		"####" A 0 A_JumpIfCloser(119, "RightAttackCleanContinue")
	RightAttack1Stop:
		"####" FGHIJ 1 
			{
				PB_SawAttack;
				A_SetRoll(roll-0.2,SPF_INTERPOLATE);
			}
		"####" A 0
			{
				if (CountInv("GreenBloodSplatterz") == 1) { 
					A_SetInventory("GreenBloodSplatterz", 0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("BlueBloodSplatterz") == 1) {	
					A_SetInventory("BlueBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("RedBloodSplatterz") == 1) {
					A_SetInventory("RedBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
				}
			}
		"####" A 0 A_StartSound ("weapons/chainsaw/loop", CHAN_7 , CHANF_LOOPING )
		"####" A 0 Saw_SwingDirection()
		TNT1 A 2 PB_ReFire("RightAttackClean2")
		"####" A 0 A_StopSound(CHAN_7)
		"####" A 0 A_StartSound("weapons/chainsaw/stop", CHAN_AUTO, CHANF_OVERLAP)
		"####" A 0 A_StartSound("CSAWSTAT", CHAN_AUTO, CHANF_OVERLAP)
		C4S1 NOPQ 1 {
				A_FireCustomMissile("GunFireSmoke", 0, 0, -5, -5, 0, 0);
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("C4S4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("C4S3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("C4S2"); }
			}
		SAWG A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("SAW4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("SAW3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("SAW2"); }
			}
		"####" GHGHGHGGHHGGHH 1 A_DoPBWeaponAction
		Goto EndCheck
	RightAttackClean2:
		"####" A 0 A_StartSound("sawswing2", CHAN_AUTO, CHANF_OVERLAP, 0.4)
		C4S1 A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("C4S4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("C4S3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("C4S2"); }
			}
		"####" JIHGF 1  A_SetRoll(roll-0.2,SPF_INTERPOLATE)
		Goto RightAttackClean2Continue+3
	RightAttackClean2Continue:
		C4S1 A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("C4S4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("C4S3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("C4S2"); }
			}
		"####" KL 1 
		"####" M 1 {
			if(PressingFire()) {
				PB_SawAttack;
				PB_SawAttack;
				PB_SawAttack;
				return state("");
			}
			else{
				return state("RightAttack2Stop");
			}
		}
		"####" A 0 A_JumpIfCloser(119, "RightAttackClean2Continue")
	RightAttack2Stop:
		"####" EDCBA 1 
			{
				PB_SawAttack;
				A_SetRoll(roll+0.2,SPF_INTERPOLATE);
			}
		"####" A 0
			{
				if (CountInv("GreenBloodSplatterz") == 1) { 
					A_SetInventory("GreenBloodSplatterz", 0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("BlueBloodSplatterz") == 1) {	
					A_SetInventory("BlueBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("RedBloodSplatterz") == 1) {
					A_SetInventory("RedBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
				}
			}
		"####" A 0 A_StartSound ("weapons/chainsaw/loop", CHAN_7 , CHANF_LOOPING |CHANF_OVERLAP )
		"####" A 0 Saw_SwingDirection()
		TNT1 A 2 PB_ReFire("RightAttackClean")
		"####" A 0 A_StopSound(CHAN_7)
		"####" A 0 A_StartSound("weapons/chainsaw/stop", CHAN_AUTO, CHANF_OVERLAP)
		"####" A 0 A_StartSound("CSAWSTAT", CHAN_AUTO, CHANF_OVERLAP)
		C4S1 RSTU 1 {
				A_FireCustomMissile("GunFireSmoke", 0, 0, -5, -5, 0, 0);
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("C4S4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("C4S3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("C4S2"); }
			}
		SAWG A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("SAW4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("SAW3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("SAW2"); }
			}
		"####" GHGHGHGGHHGGHH 1 A_DoPBWeaponAction
		Goto EndCheck
		
	LeftAttackClean:
		"####" A 0 A_StartSound("sawswing", CHAN_AUTO, 0, 0.4)
		"####" A 0 
		C5S1 A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("C5S4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("C5S3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("C5S2"); }
			}
		"####" ABCDE 1 A_SetRoll(roll-0.2,SPF_INTERPOLATE)
		Goto LeftAttackCleanContinue+3
	LeftAttackCleanContinue:
		C5S1 A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("C5S4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("C5S3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("C5S2"); }
			}
		"####" LM 1 
		"####" N 1 {
			if(PressingFire()) {
				PB_SawAttack;
				PB_SawAttack;
				PB_SawAttack;
				return state("");
			}
			else{
				return state("LeftAttack1Stop");
			}
		}
		"####" A 0 A_JumpIfCloser(119, "LeftAttackCleanContinue")
	LeftAttack1Stop:
		"####" FGHIJ 1 
			{
				PB_SawAttack;
				A_SetRoll(roll+.2,SPF_INTERPOLATE);
			}
		"####" A 0
			{
				if (CountInv("GreenBloodSplatterz") == 1) { 
					A_SetInventory("GreenBloodSplatterz", 0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("BlueBloodSplatterz") == 1) {	
					A_SetInventory("BlueBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("RedBloodSplatterz") == 1) {
					A_SetInventory("RedBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
				}
			}
		"####" A 0 A_StartSound ("weapons/chainsaw/loop", CHAN_7 , CHANF_LOOPING|CHANF_OVERLAP )
		"####" A 0 Saw_SwingDirection()
		TNT1 A 1 PB_ReFire("LeftAttackClean2")
		"####" A 0 A_StopSound(CHAN_7)
		"####" A 0 A_StartSound("weapons/chainsaw/stop", CHAN_AUTO, CHANF_OVERLAP)
		"####" A 0 A_StartSound("CSAWSTAT", CHAN_AUTO, CHANF_OVERLAP)
		C4S1 RSTU 1 {
			A_FireCustomMissile("GunFireSmoke", 0, 0, -5, -5, 0, 0);
			if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("C4S4"); }
			if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("C4S3"); }
			if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("C4S2"); }
			}
			
		SAWG A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("SAW4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("SAW3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("SAW2"); }
			}
		"####" GHGHGHGGHHGGHH 1 A_DoPBWeaponAction
		Goto EndCheck
	LeftAttackClean2:
		"####" A 0 A_StartSound("sawswing2", CHAN_AUTO, CHANF_OVERLAP, 0.4)
		C5S1 A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("C5S4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("C5S3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("C5S2"); }
			}
		"####" KJHGF 1  A_SetRoll(roll+0.2,SPF_INTERPOLATE)
		Goto LeftAttackClean2Continue+3
	LeftAttackClean2Continue:
		C5S1 A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("C5S4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("C5S3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("C5S2"); }
			}
		"####" ML 1 
		"####" N 1 {
			if(PressingFire()) {
				PB_SawAttack;
				PB_SawAttack;
				PB_SawAttack;
				return state("");
			}
			else{
				return state("LeftAttack2Stop");
			}
		}
		"####" A 0 A_JumpIfCloser(119, "LeftAttackClean2Continue")
	LeftAttack2Stop:
		"####" EDCBA 1 
			{
				PB_SawAttack;
				A_SetRoll(roll-0.2,SPF_INTERPOLATE);
			}
		"####" A 0
			{
				if (CountInv("GreenBloodSplatterz") == 1) { 
					A_SetInventory("GreenBloodSplatterz", 0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("BlueBloodSplatterz") == 1) {	
					A_SetInventory("BlueBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("RedBloodSplatterz") == 1) {
					A_SetInventory("RedBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
				}
			}
		"####" A 0 A_StartSound ("weapons/chainsaw/loop", CHAN_7 , CHANF_LOOPING | CHANF_OVERLAP  )
		"####" A 0 Saw_SwingDirection()
		TNT1 A 1 PB_ReFire("LeftAttackClean")
		"####" A 0 A_StopSound(CHAN_7)
		"####" A 0 A_StartSound("weapons/chainsaw/stop", CHAN_AUTO, CHANF_OVERLAP)
		"####" A 0 A_StartSound("CSAWSTAT", CHAN_AUTO, CHANF_OVERLAP)
		C4S1 NOPQ 1 {
			A_FireCustomMissile("GunFireSmoke", 0, 0, -5, -5, 0, 0);
			if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("C4S4"); }
			if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("C4S3"); }
			if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("C4S2"); }
			}
		SAWG A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("SAW4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("SAW3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("SAW2"); }
			}
		"####" GHGHGHGGHHGGHH 1 A_DoPBWeaponAction
		Goto EndCheck
	
	BackwardAttackClean:
		"####" A 0 A_StartSound("sawswing", CHAN_AUTO, CHANF_OVERLAP)
		C6S1 A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("C6S4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("C6S3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("C6S2"); }
			}
		"####" MNO 1
	BackwardAttackClean1:
// 		"####" A 0 A_PlaySound("weapons/gswing", 2,0.8)
		"####" ABCD 1 
		{
			A_SetRoll(roll+0.4,SPF_INTERPOLATE);
			PB_SawAttack(true);
		}
		Goto BackwardAttackCleanContinue+5
	BackwardAttackCleanContinue:
		C6S1 A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("C6S4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("C6S3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("C6S2"); }
			}
		"####" PQRS 1 {
			if(PressingFire()) {
				PB_SawAttack(true);
				return state("");
			}
			else{
				return state("BackAttackStop");
			}
		}
		"####" A 0 A_JumpIfCloser(119, "BackwardAttackCleanContinue")
	BackAttackStop:
		"####" EFG 1 PB_SawAttack(true)
		"####" HIJKLMNO 1 A_SetRoll(roll-0.2,SPF_INTERPOLATE)
		"####" A 0
			{
				if (CountInv("GreenBloodSplatterz") == 1) { 
					A_SetInventory("GreenBloodSplatterz", 0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("BlueBloodSplatterz") == 1) {	
					A_SetInventory("BlueBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("RedBloodSplatterz") == 1) {
					A_SetInventory("RedBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
				}
			}
		"####" A 0 A_StartSound ("weapons/chainsaw/loop", CHAN_7 , CHANF_LOOPING | CHANF_OVERLAP )
		"####" A 0 Saw_SwingDirection()
		"####" A 1 PB_ReFire("BackwardAttackClean1")
		"####" A 0 A_StopSound(CHAN_7)
		"####" A 0 A_StartSound("weapons/chainsaw/stop", CHAN_AUTO, CHANF_OVERLAP)
		"####" A 0 A_StartSound("CSAWSTAT", CHAN_AUTO, CHANF_OVERLAP)
		SAWG A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("SAW4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("SAW3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("SAW2"); }
			}
		"####" GHGHGHGGHHGGHH 1 A_DoPBWeaponAction
		Goto EndCheck
	
	EndCheck:
        TNT1 A 0 A_JumpIfInventory("PowerBloodOnVisor",1,"Ready.Blood")
        TNT1 A 0 A_JumpIfInventory("PowerGreenBloodOnVisor",1,"Ready.GreenBlood")
		TNT1 A 0 A_JumpIfInventory("PowerBlueBloodOnVisor",1,"Ready.BlueBlood")
		Goto Onloop

		
	FlashPunching:
		TNT1 A 0 A_JumpIfInventory ("GrabbedBarrel", 1, "FlashBarrelPunching")
		TNT1 A 0 A_JumpIfInventory ("GrabbedFlameBarrel", 1, "FlashBarrelPunching")
		TNT1 A 0 A_JumpIfInventory ("GrabbedIceBarrel", 1, "FlashBarrelPunching")
		"####" ABCDEEEDCBA 1
		Stop
	
    FlashKicking:
		TNT1 A 0 A_JumpIfInventory ("GrabbedBarrel", 1, "FlashBarrelKicking")
		TNT1 A 0 A_JumpIfInventory ("GrabbedFlameBarrel", 1, "FlashBarrelKicking")
		TNT1 A 0 A_JumpIfInventory ("GrabbedIceBarrel", 1, "FlashBarrelKicking")
		/*
		SAW4 ABCDEFG 0
		SAW3 ABCDEFG 0
		SAW2 ABCDEFG 0
		SAWG ABCDEFG 0
		CSK4 ABCDE 0
		CSK3 ABCDE 0
		CSK2 ABCDE 0
		CSK1 ABCDE 0
		*/
        CSK4 A 0 A_JumpIfInventory("PowerGreenBloodOnVisor",1,4)
		CSK3 A 0 A_JumpIfInventory("PowerBlueBloodOnVisor",1,3)
		CSK2 A 0 A_JumpIfInventory("PowerBloodOnVisor",1,2)
		CSK1 A 0 
		"####" ABCDEEEDCBA 1
		SAW4 A 0 A_JumpIfInventory("PowerGreenBloodOnVisor",1,4)
		SAW3 A 0 A_JumpIfInventory("PowerBlueBloodOnVisor",1,3)
		SAW2 A 0 A_JumpIfInventory("PowerBloodOnVisor",1,2)
		SAWG A 0 
		"####" GFEDCB 1
		Goto Onloop
		
	FlashAirKicking:
		TNT1 A 0 A_JumpIfInventory ("GrabbedBarrel", 1, "FlashBarrelAirKicking")
		TNT1 A 0 A_JumpIfInventory ("GrabbedFlameBarrel", 1, "FlashBarrelAirKicking")
		TNT1 A 0 A_JumpIfInventory ("GrabbedIceBarrel", 1, "FlashBarrelAirKicking")
		CSK4 A 0 A_JumpIfInventory("PowerGreenBloodOnVisor",1,4)
		CSK3 A 0 A_JumpIfInventory("PowerBlueBloodOnVisor",1,3)
		CSK2 A 0 A_JumpIfInventory("PowerBloodOnVisor",1,2)
		CSK1 A 0 
		"####" ABCDEEEDCBA 1
		SAW4 A 0 A_JumpIfInventory("PowerGreenBloodOnVisor",1,4)
		SAW3 A 0 A_JumpIfInventory("PowerBlueBloodOnVisor",1,3)
		SAW2 A 0 A_JumpIfInventory("PowerBloodOnVisor",1,2)
		SAWG A 0 
		"####" GFEDCB 1
		Goto Onloop
		
	FlashSlideKicking:
		TNT1 A 0 A_JumpIfInventory ("GrabbedBarrel", 1, "FlashBarrelSlideKicking")
		TNT1 A 0 A_JumpIfInventory ("GrabbedFlameBarrel", 1, "FlashBarrelSlideKicking")
		TNT1 A 0 A_JumpIfInventory ("GrabbedIceBarrel", 1, "FlashBarrelSlideKicking")
		CSK4 A 0 A_JumpIfInventory("PowerGreenBloodOnVisor",1,4)
		CSK3 A 0 A_JumpIfInventory("PowerBlueBloodOnVisor",1,3)
		CSK2 A 0 A_JumpIfInventory("PowerBloodOnVisor",1,2)
		CSK1 A 0
		"####" ABCD 1
		"####" E 16
		"####" DCBA 1
		SAW4 A 0 A_JumpIfInventory("PowerGreenBloodOnVisor",1,4)
		SAW3 A 0 A_JumpIfInventory("PowerBlueBloodOnVisor",1,3)
		SAW2 A 0 A_JumpIfInventory("PowerBloodOnVisor",1,2)
		SAWG A 0 
		"####" GFEDCB 1
		Goto Onloop
		
	FlashSlideKickingStop:
		TNT1 A 0 A_JumpIfInventory ("GrabbedBarrel", 1, "FlashBarrelSlideKickingStop")
		TNT1 A 0 A_JumpIfInventory ("GrabbedFlameBarrel", 1, "FlashBarrelSlideKickingStop")
		TNT1 A 0 A_JumpIfInventory ("GrabbedIceBarrel", 1, "FlashBarrelSlideKickingStop")
		CSK4 A 0 A_JumpIfInventory("PowerGreenBloodOnVisor",1,4)
		CSK3 A 0 A_JumpIfInventory("PowerBlueBloodOnVisor",1,3)
		CSK2 A 0 A_JumpIfInventory("PowerBloodOnVisor",1,2)
		CSK1 A 0 
		"####" DCBA 1
		SAW4 A 0 A_JumpIfInventory("PowerGreenBloodOnVisor",1,4)
		SAW3 A 0 A_JumpIfInventory("PowerBlueBloodOnVisor",1,3)
		SAW2 A 0 A_JumpIfInventory("PowerBloodOnVisor",1,2)
		SAWG A 0 
		"####" GFEDCB 1
		Goto Onloop


// New Secondary Attack and Combo-----------------------------------------------------------------------------------------------------------


	AltFire:
		TNT1 A 0 A_JumpIfInventory ("GrabbedBarrel", 1, "PlaceBarrel")
		TNT1 A 0 A_JumpIfInventory ("GrabbedFlameBarrel", 1, "PlaceFlameBarrel")
		TNT1 A 0 A_JumpIfInventory ("GrabbedIceBarrel", 1, "PlaceIceBarrel")
		C9S4 ABCDEFGHIJKLMNOPQRS 0
		C9S3 ABCDEFGHIJKLMNOPQRS 0
		C9S2 ABCDEFGHIJKLMNOPQRS 0
		C9S1 ABCDEFGHIJKLMNOPQRS 0
		
		C8S4 ABCDEFGHIJKLMNOPQRS 0
		C8S3 ABCDEFGHIJKLMNOPQRS 0
		C8S2 ABCDEFGHIJKLMNOPQRS 0
		C8S1 ABCDEFGHIJKLMNOPQRS 0
		
		C7S4 ABCDEFGHIJKLM 0
		C7S3 ABCDEFGHIJKLM 0
		C7S2 ABCDEFGHIJKLM 0
		C7S1 ABCDEFGHIJKLM 0
		
		TNT1 A 0 {
			A_WeaponOffset(0,32);
			A_SetRoll(0);
			PB_HandleCrosshair(90);
		}
		//"####" A 0 A_GiveInventory("PB_LockScreenTilt",1)
		"####" A 0 A_SetInventory("HasCutingWeapon",1)
		"####" A 0 A_JumpIfInventory("FiredGun", 1, "SlashDown")
		"####" A 0 A_JumpIfInventory("ComboSeq", 2, "ClassicAttackClean")
		C7S1 A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("C7S4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("C7S3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("C7S2"); }
			}
		"####" A 0 A_playsound("weapons/chainsaw/idle", 5)
		"####" ABCDEFGHIJKLMNOPQ 1 A_SetRoll(roll+2)
		"####" A 0
			{
				if (CountInv("GreenBloodSplatterz") == 1) { 
					A_SetInventory("GreenBloodSplatterz", 0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("BlueBloodSplatterz") == 1) {	
					A_SetInventory("BlueBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("RedBloodSplatterz") == 1) {
					A_SetInventory("RedBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
				}
			}	
		Goto SlashLeftClean


// 	AltHold:
// 		C7S1 A 0 {
// 				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("C7S4"); }
// 				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("C7S3"); }
// 				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("C7S2"); }
// 			}
// 		"####" A 0 A_playsound("weapons/chainsaw/idle", 5)
// 		"####" NOPQ 1 A_SetRoll(roll+2)
// 		TNT1 A 0 A_Jump(256,5)
// 	HoldLoop:
// 		"####" NOPQ 1
// 		"####" A 0 PB_ReFire
// 		"####" A 0 A_AlertMonsters
	SlashLeftClean:
		C7S1 A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("C7S4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("C7S3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("C7S2"); }
			}
		"####" A 0 {
			A_StartSound("sawswing", CHAN_AUTO);
			A_StartSound("weapons/gswing", CHAN_AUTO);
			A_AlertMonsters;
		}

		"####" R 1 {
			A_SetRoll(roll-6);
			if(CountInv("PB_PowerStrength") == 1){
				A_FireCustomMissile("ZerkSwing", -30, 0, 0, 9);
			}
			else {
				A_FireCustomMissile("SawSwing", -30, 0, 0, 9);
			}
		}
		"####" S 1 {
			A_SetRoll(roll-6);
			if(CountInv("PB_PowerStrength") == 1){
				A_FireCustomMissile("ZerkSwing", -15, 0, 0, 5);
			}
			else {
				A_FireCustomMissile("SawSwing", -15, 0, 0, 5);
			}
		}
		"####" T 1 {
			A_SetRoll(roll-6);
			if(CountInv("PB_PowerStrength") == 1){
				A_FireCustomMissile("ZerkSwing", -5, 0, 0, 3);
			}
			else {
				A_FireCustomMissile("SawSwing", -5, 0, 0, 3);
			}
		}
		"####" U 1 {
			A_SetRoll(roll-6);
			if(CountInv("PB_PowerStrength") == 1){
				A_FireCustomMissile("ZerkSwing", 0, 0, 0, 1);
			}
			else {
				A_FireCustomMissile("SawSwing", 0, 0, 0, 1);
			}
		}
		"####" V 1 {
			A_SetRoll(roll-6);
			if(CountInv("PB_PowerStrength") == 1){
				A_FireCustomMissile("ZerkSwing", 15, 0, 0, -2);
			}
			else {
				A_FireCustomMissile("SawSwing", 15, 0, 0, -2);
			}
		}
		"####" W 1 {
			A_SetRoll(roll-6);
			if(CountInv("PB_PowerStrength") == 1){
				A_FireCustomMissile("ZerkSwing", 30, 0, 0, -6);
			}
			else {
				A_FireCustomMissile("SawSwing", 30, 0, 0, -6);
			}
		}
		"####" XYZ 1 A_SetRoll(roll-4)
		
		"####" A 0 {
				if (CountInv("GreenBloodSplatterz") == 1) { 
					A_SetInventory("GreenBloodSplatterz", 0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("BlueBloodSplatterz") == 1) {	
					A_SetInventory("BlueBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBloodOnVisor",0);
				}
				else if (CountInv("RedBloodSplatterz") == 1) {
					A_SetInventory("RedBloodSplatterz", 0);
					A_SetInventory("PowerGreenBloodOnVisor",0);
					A_SetInventory("PowerBlueBloodOnVisor",0);
				}
			}
		
		//refire to another slash motion
		TNT1 AAAA 1 A_JumpIf(PressingAltfire() || JustPressed(BT_ALTATTACK), "SlashUp" )
		C4S1 A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("C4S4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("C4S3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("C4S2"); }
		}
		"####" RSTU 1 {
			A_SetRoll(roll+8);
			A_DoPBWeaponAction(WRF_NOFIRE);
		}
		Goto EndCheck


	SlashUp:
		C9S1 A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("C9S4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("C9S3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("C9S2"); }
			}
		"####" A 0 {
			A_StartSound("sawswing", CHAN_AUTO);
			A_StartSound("weapons/gswing", CHAN_AUTO);
			A_AlertMonsters;
		}
		"####" ABC 1 A_SetRoll(roll+1,SPF_INTERPOLATE)
		"####" A 0 A_JumpIfInventory("PB_PowerStrength", 1, "SlashUpZerk.Clean")
		"####" A 0 A_FireCustomMissile("SawSwing", 15, 0, 0, -12)
		"####" D 1 {
			A_SetRoll(roll+8);
			if(CountInv("PB_PowerStrength") == 1){
				A_FireCustomMissile("ZerkSwing", 15, 0, 0, -12);
			}
			else {
				A_FireCustomMissile("SawSwing", 15, 0, 0, -12);
			}
		}
		"####" E 1 {
			A_SetRoll(roll+8);
			if(CountInv("PB_PowerStrength") == 1){
				A_FireCustomMissile("ZerkSwing", 8, 0, 0, -6);
			}
			else {
				A_FireCustomMissile("SawSwing", 8, 0, 0, -6);
			}
		}
		"####" F 1 {
			A_SetRoll(roll+8);
			if(CountInv("PB_PowerStrength") == 1){
				A_FireCustomMissile("ZerkSwing", 0, 0, 0, 2);
			}
			else {
				A_FireCustomMissile("SawSwing", 0, 0, 0, 2);
			}
		}
		"####" G 1 {
			A_SetRoll(roll+8);
			if(CountInv("PB_PowerStrength") == 1){
				A_FireCustomMissile("ZerkSwing", -5, 0, 0, 7);
			}
			else {
				A_FireCustomMissile("SawSwing", -50, 0, 0, 7);
			}
		}
		"####" H 1 {
			A_SetRoll(roll+8);
			if(CountInv("PB_PowerStrength") == 1){
				A_FireCustomMissile("ZerkSwing", -10, 0, 0, 14);
			}
			else {
				A_FireCustomMissile("SawSwing", -10, 0, 0, 14);
			}
		}


		"####" IJK 1 A_SetRoll(roll+4)
		
		TNT1 A 0 A_JumpIf(PressingAltfire() || JustPressed(BT_ALTATTACK), "SlashDown" )
		"####" LMNOP 1 A_SetRoll(roll-1)
		"####" QR 1 A_DoPBWeaponAction(WRF_NOFIRE)
		Goto EndCheck

	SlashDown:
		C8S1 A 0 {
				if (CountInv("PowerGreenBloodOnVisor") == 1) { A_SetWeaponSprite("C8S4"); }
				if (CountInv("PowerBlueBloodOnVisor") == 1) { A_SetWeaponSprite("C8S3"); }
				if (CountInv("PowerBloodOnVisor") == 1) { A_SetWeaponSprite("C8S2"); }
			}
		"####" A 0 A_SetRoll(0)
		"####" A 0 A_AlertMonsters
		"####" A 0 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
		"####" A 0 A_SetInventory("ComboSeq", 0)
		"####" A 0 A_SetInventory("FiredGun", 0)
		"####" A 0 A_PlaySound("sawswing", 7, 0.5)
		"####" A 0 A_PlaySound("weapons/gswing", 0, 0.8)
		"####" A 0 A_Recoil(-5)

		"####" ABCD 1 
		"####" E 1 {
			if(CountInv("PB_PowerStrength") == 1){
				A_FireCustomMissile("ZerkSwing", -5, 0, 0, 14);
			}
			else {
				A_FireCustomMissile("SawSwing", -5, 0, 0, 14);
			}
		}
		"####" F 1 {
			if(CountInv("PB_PowerStrength") == 1){
				A_FireCustomMissile("ZerkSwing", 0, 0, 0, 7);
			}
			else {
				A_FireCustomMissile("SawSwing", 0, 0, 0, 7);
			}
		}
		"####" G 1 {
			if(CountInv("PB_PowerStrength") == 1){
				A_FireCustomMissile("ZerkSwing", 5, 0, 0, 2);
			}
			else {
				A_FireCustomMissile("SawSwing", 5, 0, 0, 2);
			}
		}
		"####" H 1 {
			if(CountInv("PB_PowerStrength") == 1){
				A_FireCustomMissile("ZerkSwing", 13, 0, 0, -6);
			}
			else {
				A_FireCustomMissile("SawSwing", 13, 0, 0, -6);
			}
		}
		
		"####" IJ 1 
		Goto EndCheck

	}
}


ACTOR SawSwing : FastProjectile
{
	Radius 6
	Height 6
	DamageType Cut
	Projectile 
	+FORCEXYBILLBOARD
	+NOEXTREMEDEATH
	+BLOODSPLATTER
	Damage 10
	Speed 50
	ProjectileKickBack 300
	Obituary "%o was sliced-n-diced by %k"
	SeeSound "none"
	DeathSound "none"
	Decal "SawDecalNew1"
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 1
		Stop
	XDeath:
		TNT1 A 0 //A_SpawnItemEx("BloodHit",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
		TNT1 A 0 A_PlaySound("Machete/Yum", 3)
		TNT1 A 1
		Stop
	Death:
		TNT1 A 0 A_SpawnItemEx("SSawPuff3",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
		TNT1 A 1
		Stop
	Crash:
		TNT1 A 0 A_SpawnItemEx("SSawPuff3",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
		TNT1 A 1
		Stop
	}
}


ACTOR SawNoPush : SawSwing
{
	Damage 14
	ProjectileKickBack 0
}

ACTOR ZerkSwing : SawSwing
{
	Radius 1
	Height 1
	Damage 2
	Speed 40
	ProjectileKickBack 100
	+RIPPER
	+NOBOSSRIP
	//-BLOODSPLATTER
	States
	{
	Spawn:
		TNT1 A 0
		TNT1 A 1
		TNT1 A 1
		Stop
	XDeath:
		TNT1 A 0
		TNT1 A 0 //A_SpawnItemEx("BloodHit",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
		TNT1 A 0 A_PlaySound("Machete/Yum", 3)
		TNT1 A 1
		Stop
	Death:
		TNT1 A 0
		TNT1 A 1
		Stop
	Crash:
		TNT1 A 0
		TNT1 A 1
		Stop
	}
}

ACTOR ThrustKnockdown
{
+NOBLOCKMAP
+MISSILE
Radius 2
Height 2
Damagetype ExtremePunches
States    
	{
	Spawn:
	TNT1 A 0
	TNT1 A 1
	Goto Death

	Death:
	TNT1 A 0
	TNT1 A 0 A_Explode(2,150,0)
	TNT1 A 1
	TNT1 A 0 A_Explode(2,150,0)
	TNT1 A 1
	Stop
	}
}


